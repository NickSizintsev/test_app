import sqlite3
from app.constants import ROOT_DIR, DB_NAME, TABLE_NAME

def create_database():

    # with open("app/config.yml", "r") as file:
    #     config = yaml.safe_load(file)

    try:
        # conn = sqlite3.connect(config["db_name"])
        conn = sqlite3.connect(ROOT_DIR + "/" + DB_NAME)
        cursor = conn.cursor()
    except sqlite3.Error as e:
        print(f"[ERROR] sqlite3 connect failed {e}")

    cursor.execute(f"""
        CREATE TABLE IF NOT EXISTS {TABLE_NAME} (
        user_id INT PRIMARY KEY,
        feature_1 FLOAT,
        feature_2 FLOAT,
        feature_3 FLOAT,
        feature_4 FLOAT,
        feature_5 FLOAT,
        feature_6 FLOAT,
        feature_7 FLOAT
        )
        """
    )

    user_features = (
        (1, 1.23, 2.34, 3.45, 4.56, 5.67, 6.78, 7.89),
        (2, 2.23, 3.34, 4.45, 5.56, 6.67, 7.78, 8.89),
        (3, 3.23, 4.34, 5.45, 6.56, 7.67, 8.78, 9.89),
        (4, 4.23, 5.34, 6.45, 7.56, 8.67, 9.78, 10.89),
        (5, 5.23, 6.34, 7.45, 8.56, 9.67, 10.78, 11.89),
        (6, 6.23, 7.34, 8.45, 9.56, 10.67, 11.78, 12.89),
        (7, 7.23, 8.34, 9.45, 10.56, 11.67, 12.78, 13.89),
        (8, 8.23, 9.34, 10.45, 11.56, 12.67, 13.78, 14.89),
        (9, 9.23, 10.34, 11.45, 12.56, 13.67, 14.78, 15.89),
        (10, 10.23, 11.34, 12.45, 13.56, 14.67, 15.78, 16.89),
        (11, 11.23, 12.34, 13.45, 14.56, 15.67, 16.78, 17.89),
        (12, 12.23, 13.34, 14.45, 15.56, 16.67, 17.78, 18.89),
        (13, 13.23, 14.34, 15.45, 16.56, 17.67, 18.78, 19.89),
        (14, 14.23, 15.34, 16.45, 17.56, 18.67, 19.78, 20.89),
        (15, 15.23, 16.34, 17.45, 18.56, 19.67, 20.78, 21.89),
        (16, 16.23, 17.34, 18.45, 19.56, 20.67, 21.78, 22.89),
        (17, 17.23, 18.34, 19.45, 20.56, 21.67, 22.78, 23.89),
        (18, 18.23, 19.34, 20.45, 21.56, 22.67, 23.78, 24.89),
        (19, 19.23, 20.34, 21.45, 22.56, 23.67, 24.78, 25.89),
        (20, 20.23, 21.34, 22.45, 23.56, 24.67, 25.78, 26.89),
        (21, 21.23, 22.34, 23.45, 24.56, 25.67, 26.78, 27.89),
        (22, 22.23, 23.34, 24.45, 25.56, 26.67, 27.78, 28.89),
        (23, 23.23, 24.34, 25.45, 26.56, 27.67, 28.78, 29.89),
        (24, 24.23, 25.34, 26.45, 27.56, 28.67, 29.78, 30.89),
        (25, 25.23, 26.34, 27.45, 28.56, 29.67, 30.78, 31.89),
        (26, 26.23, 27.34, 28.45, 29.56, 30.67, 31.78, 32.89),
        (27, 27.23, 28.34, 29.45, 30.56, 31.67, 32.78, 33.89),
        (28, 28.23, 29.34, 30.45, 31.56, 32.67, 33.78, 34.89)
    )

    try:
        cursor.executemany("""
            INSERT INTO users (user_id, feature_1, feature_2, feature_3, feature_4, feature_5, feature_6, feature_7)
            VALUES (?, ?, ?, ?, ?, ?, ?, ?)
            """,
            user_features
        )
        print("Database created")
    except:
        print("Database created")

    conn.commit()
    conn.close()